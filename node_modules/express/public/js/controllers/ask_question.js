'use strict';

module.exports = ['$scope', '$http', '$location', '$cookies', 'IoOperations', function($scope, $http, $location, $cookies, IoOperations) {
    var userObj = $cookies.getObject('userName');
    if (!userObj || !userObj.username) {
        $location.url('/login');
    }
    $scope.saveQuestion = function() {
        var tagsArray = $scope.tags.split(" ");
        for (var i = 0; i < tagsArray.length; i++) {
            tagsArray[i] = tagsArray[i].replace('#', '');
        }
        var data = {};
        data['title'] = $scope.title;
        data['question_body'] = $scope.questionBody;
        data['tags'] = tagsArray;
        data['authorId'] = userObj._id;
        data['userName'] = userObj.username;

        $scope.tags = '';
        $scope.title = '';
        $scope.questionBody = '';

        IoOperations.send('save-question', data, function(response) {
            console.log(response);
        }, function(response) {
            // errors
            console.log('ERROR: ', response);
        });
    }

}];