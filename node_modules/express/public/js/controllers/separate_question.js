angular.module('npAdmin').controller('SeparateQuestionCtrl', ['$scope',  '$http', '$stateParams', function($scope, $http, $stateParams) {
    $scope.questions = [
        {answersAmount: 1110, summary: 'Converting QString to char* causes heap corruption and failed debug assertions 0', tags: ['c++ 0', 'ANSI C 0']},
        {answersAmount: 1, summary: 'Converting QString to char* causes heap corruption and failed debug assertions 1', tags: ['c++ 1', 'ANSI C 1']},
        {answersAmount: 2, summary: 'Converting QString to char* causes heap corruption and failed debug assertions 2', tags: ['c++ 2', 'ANSI C 2']},
    ];

    $http.get('/get-separate-question', { params: {questionId: $stateParams.id} }).
        then(function(response) {
            console.log('111', response);

            $scope.title = response.data.separateQuestion.title;
            $scope.questionBody = response.data.separateQuestion.question_body;
            $scope.answersAmount = response.data.separateQuestion.answer_ids.length;
            $scope.answerObjs = response.data.answersText;
        }, function(response) {
            // errors
            console.log('ERROR: ', response);
        });

    $scope.addAnswer = function() {
        data = {
            answerText: $scope.answerText,
            questionId: $stateParams.id
        };
        $scope.answerText = '';
        $http.put('/add-answer', data).
            then(function(response) {
                $http.get('/get-separate-question', { params: {questionId: $stateParams.id} }).
                    then(function(response) {
                        $scope.answersAmount = response.data.separateQuestion.answer_ids.length;
                        $scope.answerObjs = response.data.answersText;
                    }, function(response) {
                        // errors
                        console.log('ERROR: ', response);
                    });
                console.log(response);
            }, function(response) {
                // errors
                console.log('ERROR: ', response);
            });
    }
}]);