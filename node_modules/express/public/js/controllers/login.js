'use strict';

module.exports = ['$scope',  '$rootScope', '$http', '$location', '$cookies', 'Email', 'IoOperations',
    function($scope, $rootScope, $http, $location, $cookies, Email, IoOperations) {
    //$scope.$watch('Email.email', function(newValue, oldValue) {
    //    console.log('newValue', newValue);
    //    console.log('oldValue', oldValue);
    //});

    $scope.getUserId = function() {
        IoOperations.send('get-user-id', {userName: $scope.userName}, function(response) {
            console.log('LoginCtrl response', response);
            $cookies.put('userName', JSON.stringify(response));
            $cookies.put('email', $scope.email);
            //Email.email = $scope.email;
            $rootScope.$broadcast("EmailWasSet", $scope.email);
            $location.url('/dashboard?questions_type=all');
        }, function(response) {
            // errors
            console.log('ERROR: ', response);
        });
    }
}];