'use strict';

module.exports = ['$scope',  '$rootScope', '$http', '$location', '$cookies', 'Email', function($scope, $rootScope, $http, $location, $cookies, Email) {
    //$scope.$watch('Email.email', function(newValue, oldValue) {
    //    console.log('newValue', newValue);
    //    console.log('oldValue', oldValue);
    //});

    $scope.getUserId = function() {
        $http.post('/get-user-id', {userName: $scope.userName}).
            then(function(response) {
                console.log('LoginCtrl response', response);
                $cookies.put('userName', JSON.stringify(response.data));
                $cookies.put('email', $scope.email);
                //Email.email = $scope.email;
                $rootScope.$broadcast("EmailWasSet", $scope.email);
                $location.url('/dashboard?questions_type=all');
            }, function(response) {
                // errors
                console.log('ERROR: ', response);
            });
    }
}];