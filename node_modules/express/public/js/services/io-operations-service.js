'use strict';

module.exports = ['Socket', function IoOperationsFactory(Socket) {
    var callbacks = [];
    var cbId = 0;

    Socket.on('response', function(data) {
        if (data.success) {
            callbacks[data.id].success(data.respData);
        } else if (callbacks[data.id].error) {
            callbacks[data.id].error(data.respData);
        }
    });

    return {
        send: function (eventName, data, successCallback, errorCallback) {
            callbacks[cbId] = {success: successCallback, error: errorCallback};
            console.log('IoOperationsFactory id = ', cbId);
            Socket.emit(eventName, {reqData: data, id: cbId});
            cbId++;
        }
    };
}];